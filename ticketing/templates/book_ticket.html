
{% block content %}
<h1>Pesan Tiket ({{ ticket.event.name }})</h1>

<form method="POST" id="bookingForm">
  {% csrf_token %}
  {{ form.as_p }}
  <button type="submit">Confirm</button>
</form>

<div id="message"></div>

<script>
document.querySelector("#bookingForm").addEventListener("submit", function(e){
  e.preventDefault();
  const formData = new FormData(this);

  fetch("", {
    method: "POST",
    headers: {"X-Requested-With": "XMLHttpRequest"},
    body: formData
  })
  .then(res => res.json())
  .then(data => {
    const msg = document.getElementById("message");
    if (data.success) {
      msg.innerHTML = "<p style='color:green'>Tiket berhasil dipesan!</p>";
    } else {
      msg.innerHTML = "<p style='color:red'>" + (data.error || "Terjadi kesalahan") + "</p>";
    }
  });
});
</script>
{% endblock %}
